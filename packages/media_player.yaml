################################################################
## Packages / Media Players
################################################################

################################################
## Customize
################################################

homeassistant:
  customize:
    ################################################
    ## Node Anchors
    ################################################

    package.node_anchors:
      customize: &customize
        package: 'media_player'

      expose: &expose
        <<: *customize
        haaska_hidden: false
        homebridge_hidden: false

    ################################################
    ## Alarm Panels
    ################################################

    ################################################
    ## Automations
    ################################################

    ################################################
    ## Binary Sensors
    ################################################

    ################################################
    ## Cameras
    ################################################

    ################################################
    ## Device Trackers
    ################################################
    
    ################################################
    ## Frontend
    ################################################
    
    ################################################
    ## Groups
    ################################################

    ################################################
    ## Input Boolean
    ################################################

    ################################################
    ## Input Numbers
    ################################################

    ################################################
    ## Input Select
    ################################################

    ################################################
    ## iOS
    ################################################

    ################################################
    ## Light
    ################################################

    ################################################
    ## Media Player
    ################################################

    ################################################
    ## Plant
    ################################################

    ################################################
    ## Proximity
    ################################################

    ################################################
    ## Scripts
    ################################################

    ################################################
    ## Sensors
    ################################################
    
    ################################################
    ## Thermostats
    ################################################

    ################################################
    ## Zone
    ################################################

########################
# Alarm Panel
########################
alarm_control_panel:

########################
## Automation
########################
automation:
  - id: play_music_in_bathroom
    alias: play_music_in_bathroom
    trigger:
      - platform: event
        event_type: tag_scanned
        event_data:
          device_id: FA07CA5F-46D6-45E8-BFFA-F021058CCA7A
          tag_id: 78025adc-36ac-4150-9514-9e68767ef13e
    action:
      - service: media_player.select_source
        data:
          entity_id: media_player.spotify
          source: Bathroom

  - id: tv_off_at_night_bed_prep
    alias: tv_off_at_night_bed_prep
    trigger:
      - platform: state
        entity_id: media_player.vizio_smartcast
        #TODO Temporary hack: ADB showing wrong values
        from: 'on'
        to: 'off'
        for: '00:00:15'
    condition:
      condition: and
      conditions:
      - condition: time
        after: '22:00:00'
        before: '04:00:00'
      - condition: state
        entity_id: input_boolean.guest_mode
        state: 'off'
    action:
      - service: scene.turn_on
        entity_id: scene.bedroom_prep
      - service: script.turn_on
        entity_id: script.spotify_bedtime

  - id: tv_paused
    alias: tv_paused
    initial_state: true
    trigger:
      - platform: state
        entity_id: media_player.living_room_firetv_2
        from: playing
        to: paused
        for: '00:00:20'
      - platform: state
        entity_id: media_player.vizio_smartcast
        #TODO Temporary hack: ADB showing wrong values
        from: playing
        to: paused
        for: '00:00:20'
      - platform: state
        entity_id: media_player.living_room_firetv_2
        #TODO Temporary hack: ADB showing wrong values
        from: paused
        to: standby
        for: '00:00:20'
    condition:
      condition: and
      conditions:
      - condition: time
        after: '19:30:00'
        before: '23:59:00'
      - condition: state
        entity_id: input_boolean.guest_mode
        state: 'off'
    action:
      - service: scene.turn_on
        entity_id: scene.tv_paused

  - id: tv_resumed
    alias: tv_resumed
    initial_state: true
    trigger:
      - platform: state
        entity_id: media_player.living_room_firetv_2
        #TODO Temporary hack: ADB showing wrong values
        from: paused
        to: playing
        for: '00:00:20'
      - platform: state
        entity_id: media_player.living_room_firetv_2
        #TODO Temporary hack: ADB showing wrong values
        from: standby
        to: paused
        for: '00:00:20'
      - platform: state
        entity_id: media_player.vizio_smartcast
        to: playing
        for: '00:00:20'
    condition:
      condition: and
      conditions:
        - condition: time
          after: '19:30:00'
          before: '23:59:00'
        - condition: state
          entity_id: input_boolean.guest_mode
          state: 'off'
    action:
      - service: scene.turn_on
        entity_id: scene.tv_resumed

########################
# Binary Sensors
########################
binary_sensor:

########################
# Cameras
########################
camera:

########################
# Device Trackers
########################
device_tracker:

########################
# Frontend
########################
frontend:

########################
# Groups
########################
group:

########################
# Input Booleans
########################
input_boolean:

########################
# Input Numbers
########################
input_number:

########################
# Input Select
########################
input_select:

########################
# iOS
########################
ios:

########################
# Light
########################
light:

########################
# Media Player
########################
media_player:
  # - platform: plex
  #   entity_namespace: 'plex'

  - platform: androidtv
    name: Living Room FireTV
    host: !secret living_room_firetv_ip
    adb_server_ip: !secret adb_server_ip
    adb_server_port: 5037
    #adbkey: "/config/androidtv/adbkey"
    apps:
      com.amazon.tv.launcher: "Fire TV"

  # - platform: spotify
  #   client_id: !secret spotify_client_id
  #   client_secret: !secret spotify_client_secret

  # - platform: vizio
  #   host: !secret vizio_tv_ip
  #   access_token: !secret vizio_tv_token

########################
# Plant
########################
plant:

########################
# Plex
########################
# Switch to integration
#plex:
#  token: !secret plex_token
#  host: fermentor.lan
  
########################
# Proximity
########################
proximity:

########################
# Scenes
########################
scene:
  - name: tv_playing_media
    entities:
      light.living_room_all_except_tv:
        state: 'off'
        transition: 20
      light.kitchen_sink:
        state: 'off'
      light.kitchen_table:
        state: 'off'
        transition: 20
      light.lava_lamp:
        state: 'off'
      light.office_ceiling:
        state: 'off'
        transition: 20
      light.office_lamp:
        state: 'off'
        transition: 20
      light.hallway_light:
        state: 'off'
        transition: 20
      light.tv:
        state: 'on'
        brightness_pct: 75
        transition: 20
      light.guest_bedroom:
        state: 'off'
        transition: 20
      switch.christmas_tree: 'off'
      switch.deck: 'off'
      switch.deck_led_string: 'off'
      switch.front_door: 'off'
      switch.stairs: 'off'
      
  - name: tv_paused
    entities: 
      light.living_room_all_except_tv:
        state: 'on'
        transition: 5
        brightness_pct: 50
      light.kitchen_sink:
        state: 'on'
        transition: 5
        brightness_pct: 100
      switch.stairs: 'on'
      
  - name: tv_resumed
    entities:
      light.living_room_all_except_tv:
        state: 'off'
        transition: 20
      light.kitchen_sink:
        state: 'off'
      light.kitchen_table:
        state: 'off'
        transition: 20
      light.lava_lamp:
        state: 'off'
      light.office_ceiling:
        state: 'off'
        transition: 20
      light.office_lamp:
        state: 'off'
        transition: 20
      light.hallway_light:
        state: 'off'
        transition: 20
      light.tv:
        state: 'on'
        brightness_pct: 25
        transition: 20
      light.guest_bedroom:
        state: 'off'
        transition: 20
      switch.christmas_tree: 'off'
      switch.deck: 'off'
      switch.deck_led_string: 'off'
      switch.front_door: 'off'
      switch.stairs: 'off'

########################
# Scripts
########################
script:
  spotify_arrival:
    alias: 'Spotify Arrive Home'
    sequence:
      - service: media_player.select_source
        data:
          entity_id: media_player.spotify
          source: "Everywhere"
      - delay:
          seconds: 2
      - service: media_player.media_pause
        data:
          entity_id: media_player.spotify
      - delay:
          seconds: 2
      - service: media_player.shuffle_set
        data:
          entity_id: media_player.spotify
        data_template:
          shuffle: >-
            {%- set shuffle = [true, false] -%}
               {% set sindex =  (range(0, (shuffle | length - 1 ) )|random) -%}
               {{ shuffle[sindex] }}
      - delay:
          seconds: 2
      - service: media_player.volume_set
        data:
          entity_id: media_player.spotify
          volume_level: 0.30
      - delay:
          seconds: 2
      - service: media_player.play_media
        data: 
          entity_id: media_player.spotify
          media_content_type: playlist
        data_template:
          media_content_id: >-
            {# 
            ## Arctic Monkeys - AM : spotify:album:78bpIziExqiI9qztvNFlQu 
            ## All Out 90s : spotify:user:spotify:playlist:37i9dQZF1DXbTxeAdrVG2l
            ## 2000s Smash Hits : spotify:user:myplay.com:playlist:2f6tXtN0XesjONxicAzMIw
            ## 2019 Sealand Invitiational : spotify:user:126202651:playlist:6uNCXLheVaTbfE1HRCIsQ5
            ## Discover Weekly: spotify:user:spotify:playlist:37i9dQZEVXcMDffrPenJPl
            ## 90s Acoustic: spotify:user:spotify:playlist:37i9dQZF1DXb9LIXaj5WhL
            ## This is Passion Pit: spotify:user:spotify:playlist:37i9dQZF1DZ06evO4iu5hu
            ## Panic! at the Disco Pretty. Odd. : spotify:album:7Hk9WbjPbN1n2GXaK7aldw
            ## This is The Mountain Goats : spotify:user:spotify:playlist:37i9dQZF1DWTmUQ5ZV8Wa1
            ## It's ALT Good! : spotify:user:spotify:playlist:37i9dQZF1DX2SK4ytI2KAZ
            ## The Griswolds : spotify:artist:3nUbzTTtP2w4HqvT5y5vkV
            ## The Wombats : spotify:artist:0Ya43ZKWHTKkAbkoJJkwIB
            ## The Decemberists @ Palace 2018 : spotify:user:126202651:playlist:4CIBhwpAL598munofpCu6i
            ## This is Jimmy Eat World : spotify:user:spotify:playlist:37i9dQZF1DX4wNVWmoZ4FM
            ## David Bowie Legacy : spotify:album:4JEgSaokMH5mMRClx9wp3S
            ## This is Cake: spotify:user:spotify:playlist:37i9dQZF1DZ06evO3T3SWA
            ## Conway Twitty: The #1 Hits Collection : spotify:album:1cE3wPf9E328RukGpUp38O
            ## SDSU : spotify:user:126202651:playlist:56WlVUutx91MElxdsbtzj1
            ## Your Top Songs 2018 : spotify:user:spotify:playlist:37i9dQZF1Ejutsu6U8IhOf
            ## Your Top Songs 2017 : spotify:user:spotify:playlist:37i9dQZF1E9G2yMdYA64HW
            ## Your Time Capsule : spotify:user:spotify:playlist:37i9dQZF1E4YuevTvB5WHT
            ## This is The Lumineers : spotify:user:spotify:playlist:37i9dQZF1DXdxZQJxjFMLO
            ## Guster @ Showbox Seattle 2/16/2019 spotify:user:126202651:playlist:65fTj3YJl4jvFmXxru7BfO
            ## Guster @ First Ave MSP 2/9/2019 spotify:user:126202651:playlist:4jmwGUvZ8XI9DmWa3NthVq
            ## Coheed & Cambria @ The Armory MSP 7/26/2018 spotify:user:126202651:playlist:5wO8RqOaWT9PDJNMnktftP
            ## Jimmy Eat World @ First Ave Minneapolis 5/9/18 spotify:user:126202651:playlist:3D3gu4wURrZfR813RTh5M8
            ## This is Passion Pit : spotify:user:spotify:playlist:37i9dQZF1DZ06evO4iu5hu
            ## Your Discovery Weekly : spotify:user:spotify:playlist:37i9dQZEVXcMDffrPenJPl
            ## Alternative 00s : spotify:user:spotify:playlist:37i9dQZF1DX0YKekzl0blG
            ## Panic at the Disco Radio : spotify:user:spotify:playlist:37i9dQZF1E4lDVOWeZX2IT
            ## Decembersits Radio : spotify:user:spotify:playlist:37i9dQZF1E4pBKIU2s8AX1
            ## Guster Radio : spotify:user:spotify:playlist:37i9dQZF1E4AQ4IdimJyYD
            ## Jimmy Eat World Radio : spotify:user:spotify:playlist:37i9dQZF1E4tDgdv9Es4ng
            ## The Lumineers Radio : spotify:user:spotify:playlist:37i9dQZF1E4Cpj7tK5yC6M
            ## Band of Hourses Radio : spotify:user:spotify:playlist:37i9dQZF1E4tcQYL2Wtnge
            ## This is Band of Horses : spotify:user:spotify:playlist:37i9dQZF1DZ06evO0pK2Aw
            ## Henry Jamison Radio : spotify:user:spotify:playlist:37i9dQZF1E4xIBgPnPOnGY
            ## Happier Radio : spotify:playlist:37i9dQZF1E8DMpUzqgcOJh
            ## Guster @ Weesner Family Ampitheater (MN Zoo), Jul 22, 2019
            ## This is Tool : spotify:playlist:37i9dQZF1DX0GDEVNHvE3h
            ## Best of the Decade 2011-2019: spotify:playlist:37i9dQZF1DXaMu9xyX1HzK
            ## Top Songs of 2019: spotify:playlist:37i9dQZF1EtiMc33WI4nNn
            ## Daily Mix 1: spotify:playlist:37i9dQZF1E37INBdbw9l8Q
            ## Daily Mix 2: spotify:playlist:37i9dQZF1E38mQjeIPb1EL
            ## Daily Mix 3: spotify:playlist:37i9dQZF1E354DBk6AJ16Y
            ## Daily Mix 4: spotify:playlist:37i9dQZF1E38XO0gwAEnvS
            ## Daily Mix 5: spotify:playlist:37i9dQZF1E37RF0IYL80qo
            ## Daily Mix 6: spotify:playlist:37i9dQZF1E38hC1b4cOQvA
            ## Summer Rewind: spotify:playlist:37i9dQZF1CAqqQ5eUaE9tb
            #}
            {%- set plists = ["spotify:album:78bpIziExqiI9qztvNFlQu", 
              "spotify:user:spotify:playlist:37i9dQZF1DXbTxeAdrVG2l",
              "spotify:user:myplay.com:playlist:2f6tXtN0XesjONxicAzMIw",
              "spotify:user:126202651:playlist:6uNCXLheVaTbfE1HRCIsQ5",
              "spotify:user:spotify:playlist:37i9dQZEVXcMDffrPenJPl",
              "spotify:user:spotify:playlist:37i9dQZF1DXb9LIXaj5WhL",
              "spotify:user:spotify:playlist:37i9dQZF1DZ06evO4iu5hu",
              "spotify:album:7Hk9WbjPbN1n2GXaK7aldw",
              "spotify:user:spotify:playlist:37i9dQZF1DWTmUQ5ZV8Wa1",
              "spotify:user:spotify:playlist:37i9dQZF1DX2SK4ytI2KAZ",
              "spotify:artist:3nUbzTTtP2w4HqvT5y5vkV",
              "spotify:artist:0Ya43ZKWHTKkAbkoJJkwIB",
              "spotify:user:126202651:playlist:4CIBhwpAL598munofpCu6i",
              "spotify:user:spotify:playlist:37i9dQZF1DX4wNVWmoZ4FM",
              "spotify:album:4JEgSaokMH5mMRClx9wp3S",
              "spotify:album:1cE3wPf9E328RukGpUp38O",
              "spotify:user:126202651:playlist:56WlVUutx91MElxdsbtzj1",
              "spotify:user:spotify:playlist:37i9dQZF1Ejutsu6U8IhOf",
              "spotify:user:spotify:playlist:37i9dQZF1E9G2yMdYA64HW",
              "spotify:user:spotify:playlist:37i9dQZF1E4YuevTvB5WHT",
              "spotify:user:spotify:playlist:37i9dQZF1DXdxZQJxjFMLO",
              "spotify:user:126202651:playlist:65fTj3YJl4jvFmXxru7BfO",
              "spotify:user:126202651:playlist:4jmwGUvZ8XI9DmWa3NthVq",
              "spotify:user:126202651:playlist:5wO8RqOaWT9PDJNMnktftP",
              "spotify:user:126202651:playlist:3D3gu4wURrZfR813RTh5M8",
              "spotify:user:spotify:playlist:37i9dQZF1DZ06evO4iu5hu",
              "spotify:user:spotify:playlist:37i9dQZEVXcMDffrPenJPl",
              "spotify:user:spotify:playlist:37i9dQZF1DX0YKekzl0blG",
              "spotify:user:spotify:playlist:37i9dQZF1E4lDVOWeZX2IT",
              "spotify:user:spotify:playlist:37i9dQZF1E4pBKIU2s8AX1",
              "spotify:user:spotify:playlist:37i9dQZF1E4AQ4IdimJyYD",
              "spotify:user:spotify:playlist:37i9dQZF1E4Cpj7tK5yC6M",
              "spotify:user:spotify:playlist:37i9dQZF1E4tcQYL2Wtnge",
              "spotify:user:spotify:playlist:37i9dQZF1E4xIBgPnPOnGY",
              "spotify:playlist:37i9dQZF1E8DMpUzqgcOJh",
              "spotify:playlist:3dj3AYHFe2RKKjdQsaOWYl",
              "spotify:playlist:37i9dQZF1DX0GDEVNHvE3h",
              "spotify:playlist:37i9dQZF1DXaMu9xyX1HzK",
              "spotify:playlist:37i9dQZF1EtiMc33WI4nNn",
              "spotify:playlist:37i9dQZF1E354DBk6AJ16Y",
              "spotify:playlist:37i9dQZF1E38mQjeIPb1EL",
              "spotify:playlist:37i9dQZF1E37INBdbw9l8Q",
              "spotify:playlist:37i9dQZF1E38XO0gwAEnvS",
              "spotify:playlist:37i9dQZF1E37RF0IYL80qo",
              "spotify:playlist:37i9dQZF1E38hC1b4cOQvA",
              "spotify:playlist:37i9dQZF1CAqqQ5eUaE9tb"
               ] -%}
              {% set pindex =  (range(0, (plists | length - 1 ) )|random) -%}
              {{ plists[pindex] }}

  spotify_bedtime:
    alias: 'Spotify Bedtime'
    sequence:
      - service: media_player.select_source
        data:
          entity_id: media_player.spotify
          source: "Not Bedroom"
      - delay:
          seconds: 2
      - service: media_player.media_pause
        data:
          entity_id: media_player.spotify
      - delay:
          seconds: 2
      - service: media_player.shuffle_set
        data:
          entity_id: media_player.spotify
        data_template:
          shuffle: >-
            {%- set shuffle = [true, false] -%}
               {% set sindex =  (range(0, (shuffle | length - 1 ) )|random) -%}
               {{ shuffle[sindex] }}
      - delay:
          seconds: 2
      - service: media_player.volume_set
        data:
          entity_id: media_player.spotify
          volume_level: 0.25
      - delay:
          seconds: 2
      - service: media_player.play_media
        data: 
          entity_id: media_player.spotify
          media_content_type: playlist
        data_template:
          media_content_id: >-
            {# 
            ## Arctic Monkeys - AM : spotify:album:78bpIziExqiI9qztvNFlQu 
            ## All Out 90s : spotify:user:spotify:playlist:37i9dQZF1DXbTxeAdrVG2l
            ## 2000s Smash Hits : spotify:user:myplay.com:playlist:2f6tXtN0XesjONxicAzMIw
            ## 2019 Sealand Invitiational : spotify:user:126202651:playlist:6uNCXLheVaTbfE1HRCIsQ5
            ## Discover Weekly: spotify:user:spotify:playlist:37i9dQZEVXcMDffrPenJPl
            ## 90s Acoustic: spotify:user:spotify:playlist:37i9dQZF1DXb9LIXaj5WhL
            ## This is Passion Pit: spotify:user:spotify:playlist:37i9dQZF1DZ06evO4iu5hu
            ## Panic! at the Disco Pretty. Odd. : spotify:album:7Hk9WbjPbN1n2GXaK7aldw
            ## This is The Mountain Goats : spotify:user:spotify:playlist:37i9dQZF1DWTmUQ5ZV8Wa1
            ## It's ALT Good! : spotify:user:spotify:playlist:37i9dQZF1DX2SK4ytI2KAZ
            ## The Griswolds : spotify:artist:3nUbzTTtP2w4HqvT5y5vkV
            ## The Wombats : spotify:artist:0Ya43ZKWHTKkAbkoJJkwIB
            ## The Decemberists @ Palace 2018 : spotify:user:126202651:playlist:4CIBhwpAL598munofpCu6i
            ## This is Jimmy Eat World : spotify:user:spotify:playlist:37i9dQZF1DX4wNVWmoZ4FM
            ## David Bowie Legacy : spotify:album:4JEgSaokMH5mMRClx9wp3S
            ## This is Cake: spotify:user:spotify:playlist:37i9dQZF1DZ06evO3T3SWA
            ## Conway Twitty: The #1 Hits Collection : spotify:album:1cE3wPf9E328RukGpUp38O
            ## SDSU : spotify:user:126202651:playlist:56WlVUutx91MElxdsbtzj1
            ## Your Top Songs 2018 : spotify:user:spotify:playlist:37i9dQZF1Ejutsu6U8IhOf
            ## Your Top Songs 2017 : spotify:user:spotify:playlist:37i9dQZF1E9G2yMdYA64HW
            ## Your Time Capsule : spotify:user:spotify:playlist:37i9dQZF1E4YuevTvB5WHT
            ## This is The Lumineers : spotify:user:spotify:playlist:37i9dQZF1DXdxZQJxjFMLO
            ## Guster @ Showbox Seattle 2/16/2019 spotify:user:126202651:playlist:65fTj3YJl4jvFmXxru7BfO
            ## Guster @ First Ave MSP 2/9/2019 spotify:user:126202651:playlist:4jmwGUvZ8XI9DmWa3NthVq
            ## Coheed & Cambria @ The Armory MSP 7/26/2018 spotify:user:126202651:playlist:5wO8RqOaWT9PDJNMnktftP
            ## Jimmy Eat World @ First Ave Minneapolis 5/9/18 spotify:user:126202651:playlist:3D3gu4wURrZfR813RTh5M8
            ## This is Passion Pit : spotify:user:spotify:playlist:37i9dQZF1DZ06evO4iu5hu
            ## Your Discovery Weekly : spotify:user:spotify:playlist:37i9dQZEVXcMDffrPenJPl
            ## Alternative 00s : spotify:user:spotify:playlist:37i9dQZF1DX0YKekzl0blG
            ## Panic at the Disco Radio : spotify:user:spotify:playlist:37i9dQZF1E4lDVOWeZX2IT
            ## Decembersits Radio : spotify:user:spotify:playlist:37i9dQZF1E4pBKIU2s8AX1
            ## Guster Radio : spotify:user:spotify:playlist:37i9dQZF1E4AQ4IdimJyYD
            ## Jimmy Eat World Radio : spotify:user:spotify:playlist:37i9dQZF1E4tDgdv9Es4ng
            ## The Lumineers Radio : spotify:user:spotify:playlist:37i9dQZF1E4Cpj7tK5yC6M
            ## Band of Hourses Radio : spotify:user:spotify:playlist:37i9dQZF1E4tcQYL2Wtnge
            ## This is Band of Horses : spotify:user:spotify:playlist:37i9dQZF1DZ06evO0pK2Aw
            ## Henry Jamison Radio : spotify:user:spotify:playlist:37i9dQZF1E4xIBgPnPOnGY
            ## Happier Radio : spotify:playlist:37i9dQZF1E8DMpUzqgcOJh
            ## Guster @ Weesner Family Ampitheater (MN Zoo), Jul 22, 2019
            ## This is Tool : spotify:playlist:37i9dQZF1DX0GDEVNHvE3h
            ## Best of the Decade 2011-2019: spotify:playlist:37i9dQZF1DXaMu9xyX1HzK
            ## Top Songs of 2019: spotify:playlist:37i9dQZF1EtiMc33WI4nNn
            ## Daily Mix 1: spotify:playlist:37i9dQZF1E37INBdbw9l8Q
            ## Daily Mix 2: spotify:playlist:37i9dQZF1E38mQjeIPb1EL
            ## Daily Mix 3: spotify:playlist:37i9dQZF1E354DBk6AJ16Y
            ## Daily Mix 4: spotify:playlist:37i9dQZF1E38XO0gwAEnvS
            ## Daily Mix 5: spotify:playlist:37i9dQZF1E37RF0IYL80qo
            ## Daily Mix 6: spotify:playlist:37i9dQZF1E38hC1b4cOQvA
            ## Summer Rewind: spotify:playlist:37i9dQZF1CAqqQ5eUaE9tb
            #}
            {%- set plists = ["spotify:album:78bpIziExqiI9qztvNFlQu", 
              "spotify:user:spotify:playlist:37i9dQZF1DXbTxeAdrVG2l",
              "spotify:user:myplay.com:playlist:2f6tXtN0XesjONxicAzMIw",
              "spotify:user:126202651:playlist:6uNCXLheVaTbfE1HRCIsQ5",
              "spotify:user:spotify:playlist:37i9dQZEVXcMDffrPenJPl",
              "spotify:user:spotify:playlist:37i9dQZF1DXb9LIXaj5WhL",
              "spotify:user:spotify:playlist:37i9dQZF1DZ06evO4iu5hu",
              "spotify:album:7Hk9WbjPbN1n2GXaK7aldw",
              "spotify:user:spotify:playlist:37i9dQZF1DWTmUQ5ZV8Wa1",
              "spotify:user:spotify:playlist:37i9dQZF1DX2SK4ytI2KAZ",
              "spotify:artist:3nUbzTTtP2w4HqvT5y5vkV",
              "spotify:artist:0Ya43ZKWHTKkAbkoJJkwIB",
              "spotify:user:126202651:playlist:4CIBhwpAL598munofpCu6i",
              "spotify:user:spotify:playlist:37i9dQZF1DX4wNVWmoZ4FM",
              "spotify:album:4JEgSaokMH5mMRClx9wp3S",
              "spotify:album:1cE3wPf9E328RukGpUp38O",
              "spotify:user:126202651:playlist:56WlVUutx91MElxdsbtzj1",
              "spotify:user:spotify:playlist:37i9dQZF1Ejutsu6U8IhOf",
              "spotify:user:spotify:playlist:37i9dQZF1E9G2yMdYA64HW",
              "spotify:user:spotify:playlist:37i9dQZF1E4YuevTvB5WHT",
              "spotify:user:spotify:playlist:37i9dQZF1DXdxZQJxjFMLO",
              "spotify:user:126202651:playlist:65fTj3YJl4jvFmXxru7BfO",
              "spotify:user:126202651:playlist:4jmwGUvZ8XI9DmWa3NthVq",
              "spotify:user:126202651:playlist:5wO8RqOaWT9PDJNMnktftP",
              "spotify:user:126202651:playlist:3D3gu4wURrZfR813RTh5M8",
              "spotify:user:spotify:playlist:37i9dQZF1DZ06evO4iu5hu",
              "spotify:user:spotify:playlist:37i9dQZEVXcMDffrPenJPl",
              "spotify:user:spotify:playlist:37i9dQZF1DX0YKekzl0blG",
              "spotify:user:spotify:playlist:37i9dQZF1E4lDVOWeZX2IT",
              "spotify:user:spotify:playlist:37i9dQZF1E4pBKIU2s8AX1",
              "spotify:user:spotify:playlist:37i9dQZF1E4AQ4IdimJyYD",
              "spotify:user:spotify:playlist:37i9dQZF1E4Cpj7tK5yC6M",
              "spotify:user:spotify:playlist:37i9dQZF1E4tcQYL2Wtnge",
              "spotify:user:spotify:playlist:37i9dQZF1E4xIBgPnPOnGY",
              "spotify:playlist:37i9dQZF1E8DMpUzqgcOJh",
              "spotify:playlist:3dj3AYHFe2RKKjdQsaOWYl",
              "spotify:playlist:37i9dQZF1DX0GDEVNHvE3h",
              "spotify:playlist:37i9dQZF1DXaMu9xyX1HzK",
              "spotify:playlist:37i9dQZF1EtiMc33WI4nNn",
              "spotify:playlist:37i9dQZF1E354DBk6AJ16Y",
              "spotify:playlist:37i9dQZF1E38mQjeIPb1EL",
              "spotify:playlist:37i9dQZF1E37INBdbw9l8Q",
              "spotify:playlist:37i9dQZF1E38XO0gwAEnvS",
              "spotify:playlist:37i9dQZF1E37RF0IYL80qo",
              "spotify:playlist:37i9dQZF1E38hC1b4cOQvA",
              "spotify:playlist:37i9dQZF1CAqqQ5eUaE9tb"
               ] -%}
              {% set pindex =  (range(0, (plists | length - 1 ) )|random) -%}
              {{ plists[pindex] }}

  spotify_wake_up:
    alias: 'Spotify Wake Up'
    sequence:
      - service: media_player.select_source
        data:
          entity_id: media_player.spotify
        data_template: 
          source: >-
            {% if is_state('input_boolean.guest_mode', 'on') %}
              Bedroom
            {% else %}
              Everywhere
            {% endif %}
      - delay:
          seconds: 2
      - service: media_player.media_pause
        data:
          entity_id: media_player.spotify
      - delay:
          seconds: 2
      - service: media_player.shuffle_set
        data:
          entity_id: media_player.spotify
        data_template:
          shuffle: >-
            {%- set shuffle = [true, false] -%}
               {% set sindex =  (range(0, (shuffle | length - 1 ) )|random) -%}
               {{ shuffle[sindex] }}
      - delay:
          seconds: 2
      - service: media_player.volume_set
        data:
          entity_id: media_player.spotify
          volume_level: 0.01
      - delay:
          seconds: 2
      - service: media_player.play_media
        data: 
          entity_id: media_player.spotify
          media_content_type: playlist
        data_template:
          media_content_id: >-
            {#
            ## Your Top Songs 2017 : spotify:user:spotify:playlist:37i9dQZF1E9G2yMdYA64HW
            ## Have a Great Day! : spotify:user:spotify:playlist:37i9dQZF1DX7KNKjOK0o75
            ## 90s Greatest Guilty Pleasures: spotify:user:patreeeek:playlist:05TbIsuVoDIQI1nfVwhpTs
            ## Alternative Nation: spotify:user:topsify:playlist:1uBI8icgYcUED3T1W1X6dB
            ## Matt & Kim Daylight Playlist: spotify:user:127725734:playlist:1tpH6e8WmMkWZNKv9HFvGK
            ## MGMT Kids Playlsit: spotify:user:gorillagoat:playlist:7aX5kvEDdre0kHNCvQ9sbr
            ## Guardians of the Galaxy Vols 1 & 2 : spotify:user:hollywdrecrds:playlist:1xY6msLHX1W34EzB0UkkbU
            ## Walk the Moon Talking is Hard: spotify:album:3mNoFlD1wsoXfkljfFzExT
            ## This is Fall Out Boy: spotify:user:spotify:playlist:37i9dQZF1DX4JbuQ72y8Ek
            ## This is Panic! at the Disco : spotify:user:spotify:playlist:37i9dQZF1DX5C8bjZ5YDv7
            ## Coheed & Cambria Good Apollo: spotify:track:4Dc5crLrKYIIqf6sk0PvQm
            ## APC Mer De Noms: spotify:album:0GeWd0yUKXHbCXVag1mJvO
            ## Matt and Kim : Lightning : spotify:album:2MbpbHn31Luzr8G3uDsSUH
            ## '90s Pop Rock Essentials : spotify:user:spotify:playlist:37i9dQZF1DX3YMp9n8fkNx
            ## 90s Rock Anthems: spotify:user:spotify:playlist:37i9dQZF1DX1rVvRgjX59F
            ## Conway Twitty - 25 Number Ones spotify:album:4GeLWE7lG3Ur3SaYaolhkh
            ## Your Top Songs 2018 : spotify:user:spotify:playlist:37i9dQZF1Ejutsu6U8IhOf
            ## Your Time Capsule : spotify:user:spotify:playlist:37i9dQZF1E4YuevTvB5WHT
            ## This is The Lumineers : spotify:user:spotify:playlist:37i9dQZF1DXdxZQJxjFMLO
            ## Guster @ Showbox Seattle 2/16/2019 spotify:user:126202651:playlist:65fTj3YJl4jvFmXxru7BfO
            ## Guster @ First Ave MSP 2/9/2019 spotify:user:126202651:playlist:4jmwGUvZ8XI9DmWa3NthVq
            ## Coheed & Cambria @ The Armory MSP 7/26/2018 spotify:user:126202651:playlist:5wO8RqOaWT9PDJNMnktftP
            ## Jimmy Eat World @ First Ave Minneapolis 5/9/18 spotify:user:126202651:playlist:3D3gu4wURrZfR813RTh5M8
            ## This is Passion Pit : spotify:user:spotify:playlist:37i9dQZF1DZ06evO4iu5hu
            ## Your Discovery Weekly : spotify:user:spotify:playlist:37i9dQZEVXcMDffrPenJPl
            ## Alternative 00s : spotify:user:spotify:playlist:37i9dQZF1DX0YKekzl0blG
            ## Panic at the Disco Radio : spotify:user:spotify:playlist:37i9dQZF1E4lDVOWeZX2IT
            ## Decembersits Radio : spotify:user:spotify:playlist:37i9dQZF1E4pBKIU2s8AX1
            ## Guster Radio : spotify:user:spotify:playlist:37i9dQZF1E4AQ4IdimJyYD
            ## Jimmy Eat World Radio : spotify:user:spotify:playlist:37i9dQZF1E4tDgdv9Es4ng
            ## The Lumineers Radio : spotify:user:spotify:playlist:37i9dQZF1E4Cpj7tK5yC6M
            ## Band of Hourses Radio : spotify:user:spotify:playlist:37i9dQZF1E4tcQYL2Wtnge
            ## This is Band of Horses : spotify:user:spotify:playlist:37i9dQZF1DZ06evO0pK2Aw
            ## Henry Jamison Radio : spotify:user:spotify:playlist:37i9dQZF1E4xIBgPnPOnGY
            ## Happier Radio : spotify:playlist:37i9dQZF1E8DMpUzqgcOJh
            ## Guster @ Weesner Family Ampitheater (MN Zoo), Jul 22, 2019
            ## This is Tool : spotify:playlist:37i9dQZF1DX0GDEVNHvE3h
            ## Best of the Decade 2011-2019: spotify:playlist:37i9dQZF1DXaMu9xyX1HzK
            ## Top Songs of 2019: spotify:playlist:37i9dQZF1EtiMc33WI4nNn
            ## Daily Mix 1: spotify:playlist:37i9dQZF1E37INBdbw9l8Q
            ## Daily Mix 2: spotify:playlist:37i9dQZF1E38mQjeIPb1EL
            ## Daily Mix 3: spotify:playlist:37i9dQZF1E354DBk6AJ16Y
            ## Daily Mix 4: spotify:playlist:37i9dQZF1E38XO0gwAEnvS
            ## Daily Mix 5: spotify:playlist:37i9dQZF1E37RF0IYL80qo
            ## Daily Mix 6: spotify:playlist:37i9dQZF1E38hC1b4cOQvA
            ## Summer Rewind: spotify:playlist:37i9dQZF1CAqqQ5eUaE9tb
            #}
            {%- set plists = ["spotify:user:spotify:playlist:37i9dQZF1E9G2yMdYA64HW", 
              "spotify:user:myplay.com:playlist:3hoI0s5TLdpPMcimSRmQpj",
              "spotify:user:patreeeek:playlist:05TbIsuVoDIQI1nfVwhpTs",
              "spotify:user:topsify:playlist:1uBI8icgYcUED3T1W1X6dB",
              "spotify:user:127725734:playlist:1tpH6e8WmMkWZNKv9HFvGK",
              "spotify:user:gorillagoat:playlist:7aX5kvEDdre0kHNCvQ9sbr",
              "spotify:user:hollywdrecrds:playlist:1xY6msLHX1W34EzB0UkkbU",
              "spotify:album:3mNoFlD1wsoXfkljfFzExT",
              "spotify:user:spotify:playlist:37i9dQZF1DX4JbuQ72y8Ek",
              "spotify:user:spotify:playlist:37i9dQZF1DX5C8bjZ5YDv7",
              "spotify:track:4Dc5crLrKYIIqf6sk0PvQm",
              "spotify:album:0GeWd0yUKXHbCXVag1mJvO",
              "spotify:album:2MbpbHn31Luzr8G3uDsSUH",
              "spotify:user:spotify:playlist:37i9dQZF1DX3YMp9n8fkNx",
              "spotify:user:spotify:playlist:37i9dQZF1DX1rVvRgjX59F",
              "spotify:album:4GeLWE7lG3Ur3SaYaolhkh",
              "spotify:user:spotify:playlist:37i9dQZF1Ejutsu6U8IhOf",
              "spotify:user:spotify:playlist:37i9dQZF1E4YuevTvB5WHT",
              "spotify:user:spotify:playlist:37i9dQZF1DXdxZQJxjFMLO",
              "spotify:user:126202651:playlist:65fTj3YJl4jvFmXxru7BfO",
              "spotify:user:126202651:playlist:4jmwGUvZ8XI9DmWa3NthVq",
              "spotify:user:126202651:playlist:5wO8RqOaWT9PDJNMnktftP",
              "spotify:user:126202651:playlist:3D3gu4wURrZfR813RTh5M8",
              "spotify:user:spotify:playlist:37i9dQZF1DZ06evO4iu5hu",
              "spotify:user:spotify:playlist:37i9dQZEVXcMDffrPenJPl",
              "spotify:user:spotify:playlist:37i9dQZF1DX0YKekzl0blG",
              "spotify:user:spotify:playlist:37i9dQZF1E4lDVOWeZX2IT",
              "spotify:user:spotify:playlist:37i9dQZF1E4pBKIU2s8AX1",
              "spotify:user:spotify:playlist:37i9dQZF1E4AQ4IdimJyYD",
              "spotify:user:spotify:playlist:37i9dQZF1E4Cpj7tK5yC6M",
              "spotify:user:spotify:playlist:37i9dQZF1E4tcQYL2Wtnge",
              "spotify:user:spotify:playlist:37i9dQZF1E4xIBgPnPOnGY",
              "spotify:playlist:37i9dQZF1E8DMpUzqgcOJh",
              "spotify:playlist:3dj3AYHFe2RKKjdQsaOWYl",
              "spotify:playlist:37i9dQZF1DX0GDEVNHvE3h",
              "spotify:playlist:37i9dQZF1DXaMu9xyX1HzK",
              "spotify:playlist:37i9dQZF1EtiMc33WI4nNn",
              "spotify:playlist:37i9dQZF1E354DBk6AJ16Y",
              "spotify:playlist:37i9dQZF1E38mQjeIPb1EL",
              "spotify:playlist:37i9dQZF1E37INBdbw9l8Q",
              "spotify:playlist:37i9dQZF1E38XO0gwAEnvS",
              "spotify:playlist:37i9dQZF1E37RF0IYL80qo",
              "spotify:playlist:37i9dQZF1E38hC1b4cOQvA",
              "spotify:playlist:37i9dQZF1CAqqQ5eUaE9tb"
               ] -%}
              {% set pindex =  (range(0, (plists | length - 1 ) )|random) -%}
              {{ plists[pindex] }}

  watch_tv:
    alias: 'Watch TV'
    sequence:
      - service: media_player.turn_on
        data:
          entity_id: media_player.living_room_firetv_2
      - wait_template: "{{ is_state('media_player.living_room_firetv_2','off') != True }}"
      - service: media_player.turn_on
        data:
          entity_id: media_player.vizio_smartcast
      - wait_template: "{{is_state('media_player.vizio_smartcast','on')}}"
      - service: media_player.select_source
        data:
          entity_id: media_player.vizio_smartcast
          source: 'HDMI-5'
      - service: media_player.select_source
        data:
          entity_id: media_player.living_room_firetv_2
          source: 'com.amazon.firetv.youtube.tv'
          #TODO Change
          #source: 'YoutubeTV'

  watch_hbo_now:
    alias: 'Watch HBO'
    sequence:
      - service: media_player.turn_on
        data:
          entity_id: media_player.living_room_firetv_2
      - wait_template: "{{ is_state('media_player.living_room_firetv_2','off') != True }}"
      - service: media_player.turn_on
        data:
          entity_id: media_player.vizio_smartcast
      - wait_template: "{{is_state('media_player.vizio_smartcast','on')}}"
      - service: media_player.select_source
        data:
          entity_id: media_player.vizio_smartcast
          source: 'HDMI-5'
      - service: media_player.select_source
        data:
          entity_id: media_player.living_room_firetv_2
          source: 'com.hbo.hbonow'

  watch_netflix:
    alias: 'Watch Netflix'
    sequence:
      - service: media_player.turn_on
        data:
          entity_id: media_player.living_room_firetv_2
      - wait_template: "{{ is_state('media_player.living_room_firetv_2','off') != True }}"
      - service: media_player.turn_on
        data:
          entity_id: media_player.vizio_smartcast
      - wait_template: "{{is_state('media_player.vizio_smartcast','on')}}"
      - service: media_player.select_source
        data:
          entity_id: media_player.vizio_smartcast
          source: 'HDMI-5'
      - service: media_player.select_source
        data:
          entity_id: media_player.living_room_firetv_2
          source: 'Netflix'
      - service: media_player.select_source
        data:
          entity_id: media_player.spotify
          source: "Everywhere"
      - delay:
          seconds: 2
      - service: media_player.media_pause
        data:
          entity_id: media_player.spotify

  watch_plex:
    alias: 'Watch Plex'
    sequence:
      - service: media_player.turn_on
        data:
          entity_id: media_player.living_room_firetv_2
      - wait_template: "{{ is_state('media_player.living_room_firetv_2','off') != True }}"
      - service: media_player.turn_on
        data:
          entity_id: media_player.vizio_smartcast
      - wait_template: "{{is_state('media_player.vizio_smartcast','on')}}"
      - service: media_player.select_source
        data:
          entity_id: media_player.vizio_smartcast
          source: 'HDMI-5'
      - service: media_player.select_source
        data:
          entity_id: media_player.living_room_firetv_2
          source: 'Plex'
      - service: media_player.select_source
        data:
          entity_id: media_player.spotify
          source: "Everywhere"
      - delay:
          seconds: 2
      - service: media_player.media_pause
        data:
          entity_id: media_player.spotify
          
  watch_letterkenny:
    alias: 'Watch Letterkenny'
    sequence:
      - service: media_player.turn_on
        data:
          entity_id: media_player.living_room_firetv_2
      - wait_template: "{{ is_state('media_player.living_room_firetv_2','off') != True }}"
      - service: media_player.turn_on
        data:
          entity_id: media_player.vizio_smartcast
      - wait_template: "{{is_state('media_player.vizio_smartcast','on')}}"
      - service: media_player.select_source
        data:
          entity_id: media_player.vizio_smartcast
          source: 'HDMI-5'
      - service: media_player.select_source
        data:
          entity_id: media_player.living_room_firetv_2
          source: 'com.plexapp.android'
      - service: media_player.select_source
        data:
          entity_id: media_player.spotify
          source: "Everywhere"
      - delay:
          seconds: 2
      - service: media_player.media_pause
        data:
          entity_id: media_player.spotify
          
  watch_popcorn_time:
    alias: 'Watch Popcorn Time'
    sequence:
      - service: media_player.turn_on
        data:
          entity_id: media_player.living_room_firetv_2
      - wait_template: "{{ is_state('media_player.living_room_firetv_2','off') != True }}"
      - service: media_player.turn_on
        data:
          entity_id: media_player.vizio_smartcast
      - wait_template: "{{is_state('media_player.vizio_smartcast','on')}}"
      - service: media_player.select_source
        data:
          entity_id: media_player.vizio_smartcast
          source: 'HDMI-5'
      - service: media_player.select_source
        data:
          entity_id: media_player.living_room_firetv_2
          source: 'pct.droid.tv'
      - service: media_player.select_source
        data:
          entity_id: media_player.spotify
          source: "Everywhere"
      - delay:
          seconds: 2
      - service: media_player.media_pause
        data:
          entity_id: media_player.spotify
          
########################
# Sensor
########################
sensor:

########################
# Spotify
########################
spotify:
  client_id: !secret spotify_client_id
  client_secret: !secret spotify_client_secret

########################
# Switch
########################
switch:

########################
# Vizio
########################
vizio:
  - host: !secret vizio_tv_ip
    access_token: !secret vizio_tv_token
########################
# Zone
########################
zone: